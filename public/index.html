<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>CoinTop Checkout</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>

<div class="card">
  <h1>CoinTop</h1>
  <p>TikTok Coins • Data • Airtime</p>

  <label>Service</label>
  <select id="service" onchange="updatePrice()">
    <option value="">-- Select Service --</option>
    <option value="tiktok">TikTok Coins</option>
    <option value="data">Mobile Data</option>
    <option value="airtime">Airtime</option>
  </select>

  <!-- TikTok -->
  <div id="tiktokBox" style="display:none">
    <label>TikTok Username</label>
    <input id="tiktokUser" placeholder="@username"/>

    <label>Coins Package</label>
    <select id="tiktokCoins" onchange="updatePrice()">
      <option value="">-- Select Coins --</option>
      <option value="350">350 Coins</option>
      <option value="700">700 Coins</option>
      <option value="1400">1400 Coins</option>
      <option value="3500">3500 Coins</option>
    </select>
  </div>

  <!-- Data -->
  <div id="dataBox" style="display:none">
    <label>Phone Number</label>
    <input id="dataPhone" placeholder="08012345678"/>

    <label>Data Bundle</label>
    <select id="dataBundle" onchange="updatePrice()">
      <option value="">-- Select Bundle --</option>
      <option value="500">500MB - ₦500</option>
      <option value="1000">1GB - ₦1000</option>
      <option value="2000">2GB - ₦2000</option>
      <option value="5000">5GB - ₦5000</option>
    </select>
  </div>

  <!-- Airtime -->
  <div id="airtimeBox" style="display:none">
    <label>Phone Number</label>
    <input id="airtimePhone" placeholder="08012345678"/>

    <label>Amount (₦)</label>
    <input type="number" id="airtimeAmount" oninput="updatePrice()" />
  </div>

  <!-- PRICE DISPLAY -->
  <div class="info">
    <strong>Total Price:</strong>
    <div style="font-size:22px; margin-top:5px; color:#00ffcc">
      ₦<span id="price">0</span>
    </div>
  </div>

  <button onclick="submitOrder()">Proceed to Checkout</button>

  <div class="footer">
    Secure • Fast • Reliable
  </div>
</div>

<script>
const prices = {
  tiktok: {
    350: 3500,
    700: 7000,
    1400: 14000,
    3500: 35000
  }
};

function updatePrice() {
  const service = document.getElementById("service").value;
  let price = 0;

  document.getElementById("tiktokBox").style.display = "none";
  document.getElementById("dataBox").style.display = "none";
  document.getElementById("airtimeBox").style.display = "none";

  if (service === "tiktok") {
    document.getElementById("tiktokBox").style.display = "block";
    const coins = document.getElementById("tiktokCoins").value;
    price = prices.tiktok[coins] || 0;
  }

  if (service === "data") {
    document.getElementById("dataBox").style.display = "block";
    price = Number(document.getElementById("dataBundle").value) || 0;
  }

  if (service === "airtime") {
    document.getElementById("airtimeBox").style.display = "block";
    price = Number(document.getElementById("airtimeAmount").value) || 0;
  }

  document.getElementById("price").innerText = price.toLocaleString();
}

async function submitOrder() {
  const service = document.getElementById("service").value;
  const price = document.getElementById("price").innerText.replace(/,/g, "");

  if (!service || price == 0) {
    alert("Please complete your selection");
    return;
  }

  const res = await fetch("/order", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      service,
      price
    })
  });

  const data = await res.json();
  alert("Order received! Admin will contact you.");
}
</script>

</body>
</html>
